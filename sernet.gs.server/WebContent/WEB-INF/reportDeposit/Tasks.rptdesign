<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.22" id="1">
    <property name="author">A. Koderman ak@sernet.de</property>
    <property name="createdBy">Eclipse BIRT Designer Version 3.7.0.v20110602 Build &lt;3.7.0.v20110607-1526></property>
    <list-property name="userProperties">
        <structure>
            <property name="name">Data Cube.ISAsTopics.x</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.ISAsTopics.y</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.ISAsTopics.width</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.ISAsTopics.height</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
    </list-property>
    <property name="Data Cube.ISAsTopics.x">97</property>
    <property name="Data Cube.ISAsTopics.y">58</property>
    <property name="Data Cube.ISAsTopics.width">150</property>
    <property name="Data Cube.ISAsTopics.height">200</property>
    <property name="units">in</property>
    <property name="iconFile">/templates/blank_report.gif</property>
    <property name="bidiLayoutOrientation">ltr</property>
    <property name="imageDPI">96</property>
    <parameters>
        <scalar-parameter name="root_object" id="609">
            <property name="hidden">true</property>
            <text-property name="helpText">Manually set root object for this report.</text-property>
            <text-property name="promptText">Root object for this report, provided by verinice in production setup.</text-property>
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">integer</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">-1</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <oda-data-source extensionID="verinice.oda.driver.dataSource.id" name="verinice" id="7">
            <property name="sncaUrl">http://localhost:8080/veriniceserver/GetHitroConfig</property>
            <property name="serverURI">http://localhost:8080/veriniceserver</property>
        </oda-data-source>
    </data-sources>
    <data-sets>
        <oda-data-set extensionID="verinice.oda.driver.dataSet.id" name="Tasks" id="3278">
            <property name="nullsOrdering">nulls lowest</property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">Assignee</property>
                    <text-property name="displayName">Assignee</text-property>
                    <text-property name="heading">Assignee</text-property>
                </structure>
                <structure>
                    <property name="columnName">Name</property>
                    <text-property name="displayName">Name</text-property>
                    <text-property name="heading">Name</text-property>
                </structure>
                <structure>
                    <property name="columnName">CreateDate</property>
                    <text-property name="displayName">CreateDate</text-property>
                    <text-property name="heading">CreateDate</text-property>
                </structure>
                <structure>
                    <property name="columnName">DueDate</property>
                    <text-property name="displayName">DueDate</text-property>
                    <text-property name="heading">DueDate</text-property>
                </structure>
                <structure>
                    <property name="columnName">CnaUuid</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">CnaUuid</text-property>
                    <text-property name="heading">CnaUuid</text-property>
                </structure>
                <structure>
                    <property name="columnName">AuditTitle</property>
                    <text-property name="displayName">AuditTitle</text-property>
                    <text-property name="heading">AuditTitle</text-property>
                </structure>
                <structure>
                    <property name="columnName">ControlTitle</property>
                    <text-property name="displayName">ControlTitle</text-property>
                    <text-property name="heading">ControlTitle</text-property>
                </structure>
                <structure>
                    <property name="columnName">Description</property>
                    <text-property name="displayName">Description</text-property>
                    <text-property name="heading">Description</text-property>
                </structure>
                <structure>
                    <property name="columnName">ElementType</property>
                    <text-property name="displayName">ElementType</text-property>
                    <text-property name="heading">ElementType</text-property>
                </structure>
                <structure>
                    <property name="columnName">IsRead</property>
                    <text-property name="displayName">IsRead</text-property>
                    <text-property name="heading">IsRead</text-property>
                </structure>
                <structure>
                    <property name="columnName">Priority</property>
                    <text-property name="displayName">Priority</text-property>
                    <text-property name="heading">Priority</text-property>
                </structure>
                <structure>
                    <property name="columnName">ProcessName</property>
                    <text-property name="displayName">ProcessName</text-property>
                    <text-property name="heading">ProcessName</text-property>
                </structure>
                <structure>
                    <property name="columnName">auditUuid</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">auditUuid</text-property>
                    <text-property name="heading">auditUuid</text-property>
                </structure>
                <structure>
                    <property name="columnName">organization</property>
                    <text-property name="displayName">organization</text-property>
                    <text-property name="heading">organization</text-property>
                </structure>
                <structure>
                    <property name="columnName">finding</property>
                    <text-property name="displayName">finding</text-property>
                    <text-property name="heading">finding</text-property>
                </structure>
                <structure>
                    <property name="columnName">measure</property>
                    <text-property name="displayName">measure</text-property>
                    <text-property name="heading">measure</text-property>
                </structure>
                <structure>
                    <property name="columnName">MajurityLevel</property>
                    <text-property name="displayName">MajurityLevel</text-property>
                    <text-property name="heading">MajurityLevel</text-property>
                </structure>
                <structure>
                    <property name="columnName">genericAuditTitle</property>
                    <text-property name="displayName">genericAuditTitle</text-property>
                    <text-property name="heading">genericAuditTitle</text-property>
                </structure>
            </list-property>
            <list-property name="parameters">
                <structure>
                    <property name="name">root_object</property>
                    <property name="paramName">root_object</property>
                    <property name="nativeName">root_object</property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">12</property>
                    <property name="position">1</property>
                    <expression name="defaultValue" type="javascript">-1</expression>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">Assignee</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">Name</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">CreateDate</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">DueDate</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">CnaUuid</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">AuditTitle</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">ControlTitle</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">Description</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">ElementType</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">IsRead</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">Priority</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                    <structure>
                        <property name="position">12</property>
                        <property name="name">ProcessName</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                    <structure>
                        <property name="position">13</property>
                        <property name="name">auditUuid</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                    <structure>
                        <property name="position">14</property>
                        <property name="name">organization</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                    <structure>
                        <property name="position">15</property>
                        <property name="name">finding</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                    <structure>
                        <property name="position">16</property>
                        <property name="name">measure</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                    <structure>
                        <property name="position">17</property>
                        <property name="name">MajurityLevel</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                    <structure>
                        <property name="position">18</property>
                        <property name="name">genericAuditTitle</property>
                        <property name="dataType">javaObject</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">verinice</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">Assignee</property>
                    <property name="nativeName">Assignee</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">Name</property>
                    <property name="nativeName">Name</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">CreateDate</property>
                    <property name="nativeName">CreateDate</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">DueDate</property>
                    <property name="nativeName">DueDate</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">CnaUuid</property>
                    <property name="nativeName">CnaUuid</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">AuditTitle</property>
                    <property name="nativeName">AuditTitle</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">ControlTitle</property>
                    <property name="nativeName">ControlTitle</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
                <structure>
                    <property name="position">8</property>
                    <property name="name">Description</property>
                    <property name="nativeName">Description</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
                <structure>
                    <property name="position">9</property>
                    <property name="name">ElementType</property>
                    <property name="nativeName">ElementType</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
                <structure>
                    <property name="position">10</property>
                    <property name="name">IsRead</property>
                    <property name="nativeName">IsRead</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
                <structure>
                    <property name="position">11</property>
                    <property name="name">Priority</property>
                    <property name="nativeName">Priority</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
                <structure>
                    <property name="position">12</property>
                    <property name="name">ProcessName</property>
                    <property name="nativeName">ProcessName</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
                <structure>
                    <property name="position">13</property>
                    <property name="name">auditUuid</property>
                    <property name="nativeName">auditUuid</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
                <structure>
                    <property name="position">14</property>
                    <property name="name">organization</property>
                    <property name="nativeName">organization</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
                <structure>
                    <property name="position">15</property>
                    <property name="name">finding</property>
                    <property name="nativeName">finding</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
                <structure>
                    <property name="position">16</property>
                    <property name="name">measure</property>
                    <property name="nativeName">measure</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
                <structure>
                    <property name="position">17</property>
                    <property name="name">MajurityLevel</property>
                    <property name="nativeName">MajurityLevel</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
                <structure>
                    <property name="position">18</property>
                    <property name="name">genericAuditTitle</property>
                    <property name="nativeName">genericAuditTitle</property>
                    <property name="dataType">javaObject</property>
                    <property name="nativeDataType">2000</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[import sernet.hui.common.*;
import sernet.verinice.service.commands.crud.*;
import sernet.verinice.report.service.commands.*;
import java.util.*;
import sernet.verinice.service.commands.crud.*;
import sernet.verinice.model.iso27k.*;
import sernet.verinice.service.commands.LoadAncestors;
import sernet.gs.ui.rcp.main.Activator;
import sernet.gs.ui.rcp.main.service.ServiceFactory;
import sernet.verinice.interfaces.bpm.ITask;
import sernet.verinice.interfaces.bpm.ITaskParameter;
import sernet.verinice.model.bpm.TaskParameter;
import sernet.springclient.RightsServiceClient;
import sernet.verinice.interfaces.ActionRightIDs;
import sernet.verinice.model.samt.SamtTopic;
import sernet.gs.service.RetrieveInfo;
import sernet.verinice.model.common.CnATreeElement;
import sernet.verinice.model.iso27k.Organization;
import sernet.verinice.model.bsi.ITVerbund;
import sernet.gs.service.NumericStringComparator;
import java.util.regex.Pattern;
import java.util.regex.Matcher;
import java.text.SimpleDateFormat;
import java.text.DateFormat;
						  

/** SamtTopics constants for backward compatibility */
String SAMT_TOPIC_CONTROLNOTE = "samt_topic_controlnote";
String PROP_AUDIT_FINDINGS = "samt_topic_audit_findings";
String PROP_MATURITY = "samt_topic_maturity";
	
List sort(List list) {
    Collections.sort(list, new Comparator() {
	    public int compare(Object o1, Object o2) {
		NumericStringComparator comp = new NumericStringComparator();
		int compareresult =  comp.compare(o1.get(5), o2.get(5));
		if(compareresult == 0){
		    return comp.compare(o1.get(6), o2.get(6));
		}else{
		    return comp.compare(o1.get(5),o2.get(5));
		}
	    }
	});
    return list;
}


CnATreeElement loadParentObject(ITask task){
    RetrieveInfo ri = RetrieveInfo.getPropertyInstance();
    LoadAncestors loadControl = new LoadAncestors(task.getElementType(), task.getUuid(), ri);
    loadControl = helper.execute(loadControl);

    return loadControl.getElement();
}


String getSamtTopicEntityProperty(CnATreeElement elem, String propertyKey){
    return (elem instanceof SamtTopic) ? ((SamtTopic) elem).getEntity().getSimpleValue(propertyKey) : "-";
}

String getAuditTitle(CnATreeElement elem) {
    Audit audit = getParentAudit(elem);
    return audit != null ? audit.getTitle() : "-";
}

Audit getParentAudit(CnATreeElement elem){

    if(elem == null) {
	return null;
    }
    
    if("audit".equals(elem.getTypeId())){
	return (Audit) elem;
    }

    return getParentAudit(elem.getParent());
}


String loadOrganizationOrVerbund(CnATreeElement elem){
    if (elem instanceof Organization ) {
	return ((Organization) elem).getTitle();
    }

    if (elem instanceof ITVerbund) {
	return ((ITVerbund) elem).getTitle();
    }

    return loadOrganizationOrVerbund(elem.getParent());
}


/** removes tags: <tag>hello</tag> -> hello */ 
String removeHTMLTags(String description){
    if(description == null)
	return "";
    else
	return description.replaceAll("\\<[^>]*>", "");
}

// set top level element for report:
root = helper.getRoot();
// try to get manual parameter if set:
myroot = _inpv.get("root_object");
if (myroot != null &amp;&amp; myroot != -1) {
    root = myroot;
}

TaskParameter param = new TaskParameter();
rightsService = (RightsServiceClient) VeriniceContext.get(VeriniceContext.RIGHTS_SERVICE);
boolean enabled =  rightsService.isEnabled(ActionRightIDs.TASKSHOWALL);
if(enabled){
    param.setAllUser(true);
}

Activator.inheritVeriniceContextState();
taskList = ServiceFactory.lookupTaskService().getTaskList(param);


List tasks = new ArrayList();
DateFormat formatter = new SimpleDateFormat();

for (ITask task : taskList) {

    List row = new ArrayList();
    CnATreeElement ancestor = loadParentObject(task);
    
    row.add(task.getAssignee());
    row.add(task.getName());
    row.add(formatter.format(task.getCreateDate()));
    row.add(formatter.format(task.getDueDate()));
    row.add(task.getUuid());
    row.add(task.getGroupTitle());
    row.add(task.getElementTitle());
    row.add(removeHTMLTags(task.getDescription()));
    row.add(task.getElementType());
    row.add(task.getIsRead());
    row.add(task.getPriority());
    row.add(task.getProcessName());
    row.add(task.getUuidGroup());
    
    row.add(loadOrganizationOrVerbund(ancestor));
    row.add(getSamtTopicEntityProperty(ancestor, PROP_AUDIT_FINDINGS));
    row.add(getSamtTopicEntityProperty(ancestor, SAMT_TOPIC_CONTROLNOTE));
    row.add(getSamtTopicEntityProperty(ancestor, PROP_MATURITY));
    row.add(getAuditTitle(ancestor));
    
    tasks.add(row);
}

sortedElements = sort(tasks);
return sortedElements ;
]]></xml-property>
            <xml-property name="designerValues"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<model:DesignValues xmlns:design="http://www.eclipse.org/datatools/connectivity/oda/design" xmlns:model="http://www.eclipse.org/birt/report/model/adapter/odaModel">
  <Version>2.0</Version>
  <DataSetParameters>
    <parameter>
      <design:ParameterDefinition>
        <design:inOutMode>In</design:inOutMode>
        <design:attributes>
          <design:identifier>
            <design:name>root_object</design:name>
            <design:position>1</design:position>
          </design:identifier>
          <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
          <design:precision>-1</design:precision>
          <design:scale>-1</design:scale>
          <design:nullability>Unknown</design:nullability>
        </design:attributes>
        <design:inputAttributes>
          <design:elementAttributes>
            <design:defaultValues>
              <design:values>dummy default value</design:values>
            </design:defaultValues>
          </design:elementAttributes>
        </design:inputAttributes>
      </design:ParameterDefinition>
    </parameter>
  </DataSetParameters>
  <design:ResultSets derivedMetaData="true">
    <design:resultSetDefinitions>
      <design:resultSetColumns>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>audit_description</design:name>
              <design:position>1</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>2000</design:nativeDataTypeCode>
            <design:precision>-1</design:precision>
            <design:scale>-1</design:scale>
            <design:nullability>Unknown</design:nullability>
            <design:uiHints>
              <design:displayName>audit_description</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>audit_description</design:label>
            <design:formattingHints>
              <design:displaySize>8</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>audit_type</design:name>
              <design:position>2</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>2000</design:nativeDataTypeCode>
            <design:precision>-1</design:precision>
            <design:scale>-1</design:scale>
            <design:nullability>Unknown</design:nullability>
            <design:uiHints>
              <design:displayName>audit_type</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>audit_type</design:label>
            <design:formattingHints>
              <design:displaySize>8</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>audit_name</design:name>
              <design:position>3</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>2000</design:nativeDataTypeCode>
            <design:precision>-1</design:precision>
            <design:scale>-1</design:scale>
            <design:nullability>Unknown</design:nullability>
            <design:uiHints>
              <design:displayName>audit_name</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>audit_name</design:label>
            <design:formattingHints>
              <design:displaySize>8</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>audit_abbr</design:name>
              <design:position>4</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>2000</design:nativeDataTypeCode>
            <design:precision>-1</design:precision>
            <design:scale>-1</design:scale>
            <design:nullability>Unknown</design:nullability>
            <design:uiHints>
              <design:displayName>audit_abbr</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>audit_abbr</design:label>
            <design:formattingHints>
              <design:displaySize>8</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>audit_enddate</design:name>
              <design:position>5</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>2000</design:nativeDataTypeCode>
            <design:precision>-1</design:precision>
            <design:scale>-1</design:scale>
            <design:nullability>Unknown</design:nullability>
            <design:uiHints>
              <design:displayName>audit_enddate</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>audit_enddate</design:label>
            <design:formattingHints>
              <design:displaySize>8</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>audit_startdate</design:name>
              <design:position>6</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>2000</design:nativeDataTypeCode>
            <design:precision>-1</design:precision>
            <design:scale>-1</design:scale>
            <design:nullability>Unknown</design:nullability>
            <design:uiHints>
              <design:displayName>audit_startdate</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>audit_startdate</design:label>
            <design:formattingHints>
              <design:displaySize>8</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>audit_tag</design:name>
              <design:position>7</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>2000</design:nativeDataTypeCode>
            <design:precision>-1</design:precision>
            <design:scale>-1</design:scale>
            <design:nullability>Unknown</design:nullability>
            <design:uiHints>
              <design:displayName>audit_tag</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>audit_tag</design:label>
            <design:formattingHints>
              <design:displaySize>8</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>audit_isa_creatmail</design:name>
              <design:position>8</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>2000</design:nativeDataTypeCode>
            <design:precision>-1</design:precision>
            <design:scale>-1</design:scale>
            <design:nullability>Unknown</design:nullability>
            <design:uiHints>
              <design:displayName>audit_isa_creatmail</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>audit_isa_creatmail</design:label>
            <design:formattingHints>
              <design:displaySize>8</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>audit_isa_creatphone</design:name>
              <design:position>9</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>2000</design:nativeDataTypeCode>
            <design:precision>-1</design:precision>
            <design:scale>-1</design:scale>
            <design:nullability>Unknown</design:nullability>
            <design:uiHints>
              <design:displayName>audit_isa_creatphone</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>audit_isa_creatphone</design:label>
            <design:formattingHints>
              <design:displaySize>8</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>audit_isa_creat</design:name>
              <design:position>10</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>2000</design:nativeDataTypeCode>
            <design:precision>-1</design:precision>
            <design:scale>-1</design:scale>
            <design:nullability>Unknown</design:nullability>
            <design:uiHints>
              <design:displayName>audit_isa_creat</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>audit_isa_creat</design:label>
            <design:formattingHints>
              <design:displaySize>8</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
      </design:resultSetColumns>
      <design:criteria/>
    </design:resultSetDefinitions>
  </design:ResultSets>
</model:DesignValues>]]></xml-property>
            <list-property name="privateDriverProperties">
                <ex-property>
                    <name>setupQueryText</name>
                    <value>import sernet.hui.common.*;


inParameters(new String[] { "root_object" });

String[] cols = new String[] {"Assignee", "Name", "CreateDate", "DueDate",
 "CnaUuid", "AuditTitle", "ControlTitle", "Description", "ElementType", "IsRead", "Priority", "ProcessName", "auditUuid", "organization", "finding", "measure", "MajurityLevel" , "genericAuditTitle"};

columns(cols);</value>
                </ex-property>
            </list-property>
        </oda-data-set>
    </data-sets>
    <styles>
        <style name="report" id="4">
            <property name="fontFamily">sans-serif</property>
            <property name="fontSize">10pt</property>
        </style>
        <style name="crosstab-cell" id="5">
            <property name="borderBottomColor">#000000</property>
            <property name="borderBottomStyle">solid</property>
            <property name="borderBottomWidth">1pt</property>
            <property name="borderLeftColor">#000000</property>
            <property name="borderLeftStyle">solid</property>
            <property name="borderLeftWidth">1pt</property>
            <property name="borderRightColor">#000000</property>
            <property name="borderRightStyle">solid</property>
            <property name="borderRightWidth">1pt</property>
            <property name="borderTopColor">#000000</property>
            <property name="borderTopStyle">solid</property>
            <property name="borderTopWidth">1pt</property>
        </style>
        <style name="crosstab" id="6">
            <property name="borderBottomColor">#CCCCCC</property>
            <property name="borderBottomStyle">solid</property>
            <property name="borderBottomWidth">1pt</property>
            <property name="borderLeftColor">#CCCCCC</property>
            <property name="borderLeftStyle">solid</property>
            <property name="borderLeftWidth">1pt</property>
            <property name="borderRightColor">#CCCCCC</property>
            <property name="borderRightStyle">solid</property>
            <property name="borderRightWidth">1pt</property>
            <property name="borderTopColor">#CCCCCC</property>
            <property name="borderTopStyle">solid</property>
            <property name="borderTopWidth">1pt</property>
        </style>
        <style name="bg_black" id="2161">
            <property name="backgroundColor">#000000</property>
            <property name="color">#FFFFFF</property>
        </style>
        <style name="bg_green" id="1847">
            <property name="backgroundColor">#66CC00</property>
        </style>
        <style name="bg_red" id="1845">
            <property name="backgroundColor">#FF4747</property>
        </style>
        <style name="bg_yellow" id="1846">
            <property name="backgroundColor">#FFE47A</property>
        </style>
    </styles>
    <page-setup>
        <simple-master-page name="Simple MasterPage" id="2">
            <property name="type">a4</property>
            <property name="orientation">landscape</property>
        </simple-master-page>
    </page-setup>
    <body>
        <table id="3279">
            <property name="width">11.177083333333334in</property>
            <property name="dataSet">Tasks</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">Assignee</property>
                    <text-property name="displayName">Assignee</text-property>
                    <expression name="expression" type="javascript">dataSetRow["Assignee"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
                <structure>
                    <property name="name">Name</property>
                    <text-property name="displayName">Name</text-property>
                    <expression name="expression" type="javascript">dataSetRow["Name"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
                <structure>
                    <property name="name">CreateDate</property>
                    <text-property name="displayName">CreateDate</text-property>
                    <expression name="expression" type="javascript">dataSetRow["CreateDate"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
                <structure>
                    <property name="name">DueDate</property>
                    <text-property name="displayName">DueDate</text-property>
                    <expression name="expression" type="javascript">dataSetRow["DueDate"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
                <structure>
                    <property name="name">CnaUuid</property>
                    <text-property name="displayName">CnaUuid</text-property>
                    <expression name="expression" type="javascript">dataSetRow["CnaUuid"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
                <structure>
                    <property name="name">AuditTitle</property>
                    <text-property name="displayName">AuditTitle</text-property>
                    <expression name="expression" type="javascript">dataSetRow["AuditTitle"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
                <structure>
                    <property name="name">ControlTitle</property>
                    <text-property name="displayName">ControlTitle</text-property>
                    <expression name="expression" type="javascript">dataSetRow["ControlTitle"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
                <structure>
                    <property name="name">ElementType</property>
                    <text-property name="displayName">ElementType</text-property>
                    <expression name="expression" type="javascript">dataSetRow["ElementType"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
                <structure>
                    <property name="name">IsRead</property>
                    <text-property name="displayName">IsRead</text-property>
                    <expression name="expression" type="javascript">dataSetRow["IsRead"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
                <structure>
                    <property name="name">Priority</property>
                    <text-property name="displayName">Priority</text-property>
                    <expression name="expression" type="javascript">dataSetRow["Priority"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
                <structure>
                    <property name="name">auditUuid</property>
                    <text-property name="displayName">auditUuid</text-property>
                    <expression name="expression" type="javascript">dataSetRow["auditUuid"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
                <structure>
                    <property name="name">finding</property>
                    <text-property name="displayName">finding</text-property>
                    <expression name="expression" type="javascript">dataSetRow["finding"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
                <structure>
                    <property name="name">measure</property>
                    <text-property name="displayName">measure</text-property>
                    <expression name="expression" type="javascript">dataSetRow["measure"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
                <structure>
                    <property name="name">Description</property>
                    <text-property name="displayName">Description</text-property>
                    <expression name="expression" type="javascript">dataSetRow["Description"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
                <structure>
                    <property name="name">ProcessName</property>
                    <text-property name="displayName">ProcessName</text-property>
                    <expression name="expression" type="javascript">dataSetRow["ProcessName"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
                <structure>
                    <property name="name">organization</property>
                    <text-property name="displayName">organization</text-property>
                    <expression name="expression" type="javascript">dataSetRow["organization"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
                <structure>
                    <property name="name">MajurityLevel</property>
                    <text-property name="displayName">MajurityLevel</text-property>
                    <expression name="expression" type="javascript">dataSetRow["MajurityLevel"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
                <structure>
                    <property name="name">genericAuditTitle</property>
                    <text-property name="displayName">genericAuditTitle</text-property>
                    <expression name="expression" type="javascript">dataSetRow["genericAuditTitle"]</expression>
                    <property name="dataType">javaObject</property>
                </structure>
            </list-property>
            <structure name="toc"/>
            <column id="3389">
                <property name="width">1in</property>
                <property name="repeat">1</property>
            </column>
            <column id="3353">
                <property name="width">0.4270833333333333in</property>
                <property name="repeat">1</property>
            </column>
            <column id="3354">
                <property name="width">0.9791666666666666in</property>
                <property name="repeat">1</property>
            </column>
            <column id="3356">
                <property name="width">0.5104166666666666in</property>
                <property name="repeat">1</property>
            </column>
            <column id="3349">
                <property name="width">0.9270833333333334in</property>
                <property name="repeat">1</property>
            </column>
            <column id="3355">
                <property name="width">0.96875in</property>
                <property name="repeat">1</property>
            </column>
            <column id="3348">
                <property name="width">0.5729166666666666in</property>
            </column>
            <column id="3350">
                <property name="width">0.5833333333333334in</property>
                <property name="textAlign">center</property>
            </column>
            <column id="3358">
                <property name="width">0.5833333333333334in</property>
                <property name="textAlign">center</property>
            </column>
            <column id="3351">
                <property name="width">0.625in</property>
                <property name="repeat">1</property>
                <property name="textAlign">center</property>
            </column>
            <column id="3357">
                <property name="width">0.46875in</property>
                <property name="repeat">1</property>
                <property name="textAlign">center</property>
            </column>
            <column id="3360">
                <property name="width">0.8541666666666666in</property>
            </column>
            <header>
                <row id="3280">
                    <property name="height">0.5520833333333334in</property>
                    <property name="backgroundColor">silver</property>
                    <property name="textAlign">left</property>
                    <cell id="3387">
                        <label id="3390">
                            <text-property name="text">Organization / Scope</text-property>
                        </label>
                    </cell>
                    <cell id="3291">
                        <label id="3292">
                            <text-property name="text">Audit Object</text-property>
                        </label>
                    </cell>
                    <cell id="3293">
                        <label id="3294">
                            <text-property name="text">Object Title</text-property>
                        </label>
                    </cell>
                    <cell id="3297">
                        <label id="3298">
                            <text-property name="text">Typ</text-property>
                        </label>
                    </cell>
                    <cell id="3283">
                        <label id="3284">
                            <text-property name="text">Task</text-property>
                        </label>
                    </cell>
                    <cell id="3295">
                        <label id="3296">
                            <property name="marginLeft">0pt</property>
                            <property name="textAlign">left</property>
                            <text-property name="text">Description</text-property>
                        </label>
                    </cell>
                    <cell id="3281">
                        <label id="3282">
                            <property name="marginLeft">0pt</property>
                            <property name="marginRight">0pt</property>
                            <text-property name="text">Assignee</text-property>
                        </label>
                    </cell>
                    <cell id="3285">
                        <label id="3286">
                            <property name="marginRight">0pt</property>
                            <text-property name="text">create date</text-property>
                        </label>
                    </cell>
                    <cell id="3301">
                        <label id="3302">
                            <text-property name="text">priority</text-property>
                        </label>
                    </cell>
                    <cell id="3287">
                        <label id="3288">
                            <property name="marginLeft">0pt</property>
                            <text-property name="text">due date</text-property>
                        </label>
                    </cell>
                    <cell id="3299">
                        <label id="3300">
                            <text-property name="text">read state</text-property>
                        </label>
                    </cell>
                    <cell id="3305">
                        <label id="3306">
                            <text-property name="text">Object Uuid</text-property>
                        </label>
                    </cell>
                </row>
            </header>
            <detail>
                <row id="3307">
                    <property name="height">0.53125in</property>
                    <cell id="3388">
                        <data id="3391">
                            <property name="resultSetColumn">organization</property>
                        </data>
                    </cell>
                    <cell id="3318">
                        <data id="3397">
                            <property name="resultSetColumn">genericAuditTitle</property>
                        </data>
                    </cell>
                    <cell id="3320">
                        <data id="3321">
                            <property name="marginLeft">0pt</property>
                            <property name="marginRight">0pt</property>
                            <property name="display">block</property>
                            <property name="resultSetColumn">ControlTitle</property>
                        </data>
                    </cell>
                    <cell id="3324">
                        <data id="3325">
                            <property name="marginRight">0.5cm</property>
                            <list-property name="mapRules">
                                <structure>
                                    <expression name="testExpr" type="javascript">row["ElementType"]</expression>
                                    <property name="operator">eq</property>
                                    <simple-property-list name="value1">
                                        <value type="javascript">"samt_topic"</value>
                                    </simple-property-list>
                                    <text-property name="display">ISA Control</text-property>
                                </structure>
                                <structure>
                                    <expression name="testExpr" type="javascript">row["ElementType"]</expression>
                                    <property name="operator">eq</property>
                                    <simple-property-list name="value1">
                                        <value type="javascript">"control"</value>
                                    </simple-property-list>
                                    <text-property name="display">Control</text-property>
                                </structure>
                                <structure>
                                    <expression name="testExpr" type="javascript">row["ElementType"]</expression>
                                    <property name="operator">eq</property>
                                    <simple-property-list name="value1">
                                        <value type="javascript">"finding"</value>
                                    </simple-property-list>
                                    <text-property name="display">Finding</text-property>
                                </structure>
                            </list-property>
                            <property name="resultSetColumn">ElementType</property>
                        </data>
                    </cell>
                    <cell id="3310">
                        <data id="3311">
                            <property name="marginLeft">0pt</property>
                            <property name="marginRight">0pt</property>
                            <property name="resultSetColumn">Name</property>
                        </data>
                    </cell>
                    <cell id="3322">
                        <data id="3386">
                            <property name="resultSetColumn">Description</property>
                        </data>
                    </cell>
                    <cell id="3308">
                        <data id="3309">
                            <property name="marginRight">0pt</property>
                            <property name="resultSetColumn">Assignee</property>
                        </data>
                    </cell>
                    <cell id="3312">
                        <data id="3399">
                            <structure name="dateTimeFormat">
                                <property name="category">Unformatted</property>
                            </structure>
                            <structure name="stringFormat">
                                <property name="category">Unformatted</property>
                            </structure>
                            <property name="resultSetColumn">CreateDate</property>
                        </data>
                    </cell>
                    <cell id="3328">
                        <data id="3329">
                            <property name="marginRight">0.5cm</property>
                            <list-property name="mapRules">
                                <structure>
                                    <expression name="testExpr" type="javascript">row["Priority"]</expression>
                                    <property name="operator">eq</property>
                                    <simple-property-list name="value1">
                                        <value type="javascript">"NORMAL"</value>
                                    </simple-property-list>
                                    <text-property name="display">normal</text-property>
                                </structure>
                            </list-property>
                            <property name="resultSetColumn">Priority</property>
                        </data>
                    </cell>
                    <cell id="3314">
                        <data id="3400">
                            <structure name="dateTimeFormat">
                                <property name="category">Unformatted</property>
                            </structure>
                            <property name="resultSetColumn">DueDate</property>
                        </data>
                    </cell>
                    <cell id="3326">
                        <data id="3327">
                            <property name="marginRight">0.5cm</property>
                            <list-property name="mapRules">
                                <structure>
                                    <expression name="testExpr" type="javascript">row["IsRead"]</expression>
                                    <property name="operator">is-true</property>
                                    <text-property name="display">read</text-property>
                                </structure>
                                <structure>
                                    <expression name="testExpr" type="javascript">row["IsRead"]</expression>
                                    <property name="operator">is-false</property>
                                    <text-property name="display">not read</text-property>
                                </structure>
                            </list-property>
                            <property name="resultSetColumn">IsRead</property>
                        </data>
                    </cell>
                    <cell id="3332">
                        <data id="3398">
                            <property name="resultSetColumn">CnaUuid</property>
                        </data>
                    </cell>
                </row>
            </detail>
        </table>
    </body>
</report>
