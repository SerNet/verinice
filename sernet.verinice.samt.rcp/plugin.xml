<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>

   <extension
         point="org.eclipse.ui.views">
      <category
            name="%category.name"
            id="sernet.verinice.samt.rcp">
      </category>
      <view
            name="%view.name"
            icon="icons/vda.png"
            category="sernet.verinice.samt.rcp"
            class="sernet.verinice.samt.rcp.SamtView"
            id="sernet.verinice.samt.rcp.views.SamtView">
      </view>
      <view
            name="%view.name.5"
            icon="icons/self-assessment.png"
            category="sernet.verinice.samt.rcp"
            class="sernet.verinice.samt.audit.rcp.SimpleAuditView"
            id="sernet.verinice.samt.rcp.views.SimpleAuditView">
      </view>
      <view
            category="sernet.verinice.samt.rcp"
            class="sernet.verinice.samt.rcp.SpiderChartView"
            icon="icons/chart.png"
            id="sernet.verinice.samt.rcp.SpiderChartView"
            name="%view.name.0"
            restorable="true">
      </view>
      <view
            allowMultiple="true"
            category="sernet.verinice.samt.rcp"
            class="sernet.verinice.samt.audit.rcp.OrganizationView"
            icon="icons/organization.gif"
            id="sernet.verinice.samt.audit.rcp.OrganizationView"
            name="%view.name.1">
      </view> 
      <view
            allowMultiple="true"
            category="sernet.verinice.samt.rcp"
            class="sernet.verinice.samt.audit.rcp.AuditView"
            icon="icons/audit.png"
            id="sernet.verinice.samt.audit.rcp.AuditView"
            name="%view.name.2">
      </view>
      <view
            allowMultiple="true"
            category="sernet.verinice.samt.rcp"
            class="sernet.verinice.samt.audit.rcp.AssetView"
            icon="icons/asset.png"
            id="sernet.verinice.samt.audit.rcp.AssetView"
            name="%view.name.3">
      </view>
      <view
            allowMultiple="true"
            category="sernet.verinice.samt.rcp"
            class="sernet.verinice.samt.audit.rcp.ControlView"
            icon="icons/control.png"
            id="sernet.verinice.samt.audit.rcp.ControlView"
            name="%view.name.4">
      </view>
   </extension>
   <extension
         point="org.eclipse.ui.perspectives">
      <perspective
            class="sernet.verinice.samt.rcp.SamtPerspective"
            id="sernet.verinice.samt.rcp.SamtPerspective"
            name="%perspective.name"
            icon="icons/vda.png">
      </perspective>
   </extension>
   <extension point="org.eclipse.ui.menus">
   	  <menuContribution locationURI="popup:sernet.verinice.samt.rcp.views.SimpleAuditView?after=additions">
         <command
               commandId="org.eclipse.ui.edit.cut"
               disabledIcon="icons/cut.png"
               icon="icons/cut.png"
               label="%command.label"/>
         <command
               commandId="org.eclipse.ui.edit.copy"
               disabledIcon="icons/copy.png"
               icon="icons/copy.png"
               label="%command.label.0"/>
         <command
               commandId="org.eclipse.ui.edit.paste"
               disabledIcon="icons/copy.png"
               icon="icons/paste.png"
               label="%command.label.1"/>
      </menuContribution>  
      <menuContribution locationURI="popup:sernet.verinice.samt.rcp.views.SamtView?after=special">
         <command
               commandId="sernet.verinice.rcp.unify"
               disabledIcon="icons/konsolidator.png"
               icon="icons/konsolidator.png"
               label="%command.label.2"/>
      </menuContribution>
   </extension>
   <extension
         point="org.eclipse.ui.viewActions">
      <viewContribution
            id="sernet.verinice.samt.addSelfAssessment"
            targetID="sernet.verinice.samt.rcp.views.SamtView">
         <action
               class="sernet.verinice.samt.rcp.AddSelfAssessment"
               icon="icons/new.png"
               id="sernet.verinice.samt.rcp.AddSelfAssessment"
               label="%action.label"
               state="true"
               style="push"
               toolbarPath="workflow"
               tooltip="%action.tooltip">
         </action>
      </viewContribution>
      <viewContribution
            id="sernet.verinice.samt.exportSelfAssessment"
            targetID="sernet.verinice.samt.rcp.views.SamtView">
         <action
               class="sernet.verinice.iso27k.rcp.action.ExportAction"
               icon="icons/export.gif"
               id="sernet.verinice.iso27k.rcp.action.ExportAction"
               label="%action.label.6"
               state="true"
               style="push"
               toolbarPath="additions"
               tooltip="%action.tooltip.0">
         </action>
      </viewContribution>
      <viewContribution
            id="sernet.verinice.samt.audit.rcp.AuditView.switch"
            targetID="sernet.verinice.samt.audit.rcp.AuditView">
         <action
               class="sernet.verinice.samt.audit.rcp.SwitchElementMenuCreater"
               icon="icons/filter.gif"
               id="sernet.verinice.samt.audit.rcp.SwitchElement"
               label="%action.label.7"
               style="pulldown"
               toolbarPath="additions">
         </action>
      </viewContribution>
      <viewContribution
            id="sernet.verinice.samt.audit.rcp.AuditView.add"
            targetID="sernet.verinice.samt.audit.rcp.AuditView">
         <action
               class="sernet.verinice.samt.audit.rcp.AddMenuCreater"
               icon="icons/new.png"
               id="sernet.verinice.samt.audit.rcp.AddAudit"
               label="%action.label.8"
               style="pulldown"
               toolbarPath="additions">
         </action>
      </viewContribution>
      <viewContribution
            id="sernet.verinice.samt.audit.rcp.AssetView.switch"
            targetID="sernet.verinice.samt.audit.rcp.AssetView">
         <action
               class="sernet.verinice.samt.audit.rcp.SwitchElementMenuCreater"
               icon="icons/filter.gif"
               id="sernet.verinice.samt.audit.rcp.SwitchElement"
               label="%action.label.9"
               style="pulldown"
               toolbarPath="additions">
         </action>
      </viewContribution>
      <viewContribution
            id="sernet.verinice.samt.audit.rcp.AssetView.add"
            targetID="sernet.verinice.samt.audit.rcp.AssetView">
         <action
               class="sernet.verinice.samt.audit.rcp.AddMenuCreater"
               icon="icons/new.png"
               id="sernet.verinice.samt.audit.rcp.AddAsset"
               label="%action.label.10"
               style="pulldown"
               toolbarPath="additions">
         </action>
      </viewContribution>
      <viewContribution
            id="sernet.verinice.samt.audit.rcp.ControlView.switch"
            targetID="sernet.verinice.samt.audit.rcp.ControlView">
         <action
               class="sernet.verinice.samt.audit.rcp.SwitchElementMenuCreater"
               icon="icons/filter.gif"
               id="sernet.verinice.samt.audit.rcp.SwitchElement"
               label="%action.label.11"
               style="pulldown"
               toolbarPath="additions">
         </action>
      </viewContribution>
      <viewContribution
            id="sernet.verinice.samt.audit.rcp.AssetView.add"
            targetID="sernet.verinice.samt.audit.rcp.ControlView">
         <action
               class="sernet.verinice.samt.audit.rcp.AddMenuCreater"
               icon="icons/new.png"
               id="sernet.verinice.samt.audit.rcp.AddControl"
               label="%action.label.12"
               style="pulldown"
               toolbarPath="additions">
         </action>
      </viewContribution>
      <viewContribution
            id="sernet.verinice.samt.rcp.addOrganization"
            targetID="sernet.verinice.samt.rcp.views.SimpleAuditView">
         <action
               class="sernet.verinice.iso27k.rcp.action.AddOrganisation"
               icon="icons/new.png"
               id="sernet.verinice.samt.rcp.action.AddOrganisation"
               label="%action.label.14"
               state="true"
               style="push"
               toolbarPath="additions"
               tooltip="%action.tooltip.2">
         </action>
      </viewContribution>
   </extension>
   <extension
         point="org.eclipse.ui.preferencePages">
      <page
            class="sernet.verinice.samt.rcp.SamtPreferencePage"
            id="sernet.verinice.samt.rcp.SamtPreferencePage"
            name="%page.name">
      </page>
   </extension>
   <extension
         point="org.eclipse.ui.cheatsheets.cheatSheetContent">
      <category
            id="sernet.verinice.samt.rcp.cheatSheets"
            name="%cheatsheets.category.1"/>
      <cheatsheet
            category="sernet.verinice.samt.rcp.cheatSheets"
            composite="false"
            contentFile="%cheatsheets.content.1"
            id="sernet.verinice.samt.rcp.cheatSheets.GettingStarted"
            name="%cheatsheets.1">
         <description>%cheatsheets.description.1</description>
      </cheatsheet>
    </extension>
   <extension
         point="org.eclipse.ui.actionSets">
      <actionSet
            id="sernet.verinice.samt.rcp.actionSet1"
            label="%actionSet.label"
            visible="true">
         <action
               class="sernet.verinice.samt.rcp.ShowSamtViewAction"
               icon="icons/self-assessment.png"
               id="sernet.verinice.samt.rcp.ShowSamtViewAction"
               label="%action.label.0"
               menubarPath="window/vn_menu_views/additions"
               style="push">
         </action>
         <action
               class="sernet.verinice.samt.rcp.ShowSpiderChartACtion"
               icon="icons/chart.png"
               id="sernet.verinice.samt.rcp.ShowMaturitySummaryAction"
               label="%action.label.1"
               menubarPath="window/vn_menu_views/additions"
               style="push">
         </action>
         <action
               class="sernet.verinice.samt.rcp.ShowSamtPerspectiveAction"
               icon="icons/self-assessment.png"
               id="sernet.verinice.samt.rcp.ShowSamtPerspectiveAction"
               label="%action.label.2"
               menubarPath="window/vn_menu_perspectives/additions"
               style="push">
         </action>
         <action
               class="sernet.verinice.samt.rcp.AddSelfAssessmentMenuAction"
               icon="icons/new.png"
               id="sernet.verinice.samt.rcp.AddSelfAssessmentMenuAction"
               label="%action.label.3"
               menubarPath="file/sernet.verinice.samt.rcp.menu1/slot1"
               style="push">
         </action>
         <menu
               icon="icons/self-assessment.png"
               id="sernet.verinice.samt.rcp.menu1"
               label="%menu.label"
               path="file/vn_menu_file">
            <groupMarker
                  name="slot1">
            </groupMarker>
         </menu>
         <action
               class="sernet.verinice.iso27k.rcp.action.ExportAction"
               icon="icons/export.gif"
               id="sernet.verinice.samt.rcp.exporttofile"
               label="%action.label.5"
               menubarPath="file/sernet.verinice.samt.rcp.menu1/slot1"
               style="push">
         </action>
      </actionSet>
   </extension>
   <extension
         point="org.eclipse.ui.cheatsheets.cheatSheetItemExtension">
		 <itemExtension
		   itemAttribute="vnicon"
		   class="none">
		 </itemExtension>
   </extension>
   <extension point="org.eclipse.ui.handlers">
      <handler
            class="sernet.verinice.iso27k.rcp.action.CopyHandler"
            commandId="org.eclipse.ui.edit.copy">
         <activeWhen>
         	<with variable="activePartId">
     			<or>
       				<equals value="sernet.verinice.samt.audit.rcp.AssetView" />
       				<equals value="sernet.verinice.samt.audit.rcp.AuditView" />
       				<equals value="sernet.verinice.samt.audit.rcp.ControlView" />
       				<equals value="sernet.verinice.samt.rcp.views.SimpleAuditView" />
       			</or>
    		</with>
         </activeWhen>
      </handler>
      <handler
            class="sernet.verinice.iso27k.rcp.action.CutHandler"
            commandId="org.eclipse.ui.edit.cut">
         <activeWhen>
     		<with variable="activePartId">
     			<or>
       				<equals value="sernet.verinice.samt.audit.rcp.AssetView" />
       				<equals value="sernet.verinice.samt.audit.rcp.AuditView" />
       				<equals value="sernet.verinice.samt.audit.rcp.ControlView" />
       				<equals value="sernet.verinice.samt.rcp.views.SimpleAuditView" />
       			</or>
    		</with>
         </activeWhen>
      </handler>
      <handler
            class="sernet.verinice.iso27k.rcp.action.PasteHandler"
            commandId="org.eclipse.ui.edit.paste">
         <activeWhen>
         	<with variable="activePartId">
     			<or>
       				<equals value="sernet.verinice.samt.audit.rcp.AssetView" />
       				<equals value="sernet.verinice.samt.audit.rcp.AuditView" />
       				<equals value="sernet.verinice.samt.audit.rcp.ControlView" />
       				<equals value="sernet.verinice.samt.rcp.views.SimpleAuditView" />
       			</or>
    		</with>
         </activeWhen> 
         <enabledWhen>
			<with variable="selection">
				<iterate operator="and">
				    <instanceof value="sernet.verinice.model.common.CnATreeElement"/>
				    <test property="sernet.verinice.iso27k.model.cutCopy"/>              
				</iterate>
			</with>
		 </enabledWhen>
      </handler>
   </extension>
   <extension point="org.eclipse.ui.decorators">
          <decorator
	            adaptable="true"
	            class="sernet.verinice.samt.rcp.TopicGroupDecorator"
	            id="sernet.verinice.samt.rcp.AuditDecorator"
	            label="ISA Audit decorator"
	            lightweight="true"
	            location="BOTTOM_RIGHT"
	            state="true">
	         <enablement>
	         	<objectClass name="sernet.verinice.model.iso27k.Audit"/>        
	         </enablement>
	      </decorator>
	      <decorator
	            adaptable="true"
	            class="sernet.verinice.samt.rcp.TopicGroupDecorator"
	            id="sernet.verinice.samt.rcp.TopicGroupDecorator"
	            label="ISA Topic group decorator"
	            lightweight="true"
	            location="TOP_LEFT"
	            state="true">
	         <enablement>
	         	<objectClass name="sernet.verinice.model.iso27k.ControlGroup"/>        
	         </enablement>
	      </decorator>
	      <decorator
	            adaptable="true"
	            class="sernet.verinice.samt.rcp.TopicDecorator"
	            id="sernet.verinice.samt.rcp.TopicDecorator"
	            label="ISA Topic decorator"
	            lightweight="true"
	            location="TOP_LEFT"
	            state="true">
	         <enablement>
	         	<objectClass name="sernet.verinice.model.samt.SamtTopic"/>        
	         </enablement>
	      </decorator>
   </extension>
   <extension
         point="org.eclipse.ui.popupMenus">
      <objectContribution
            adaptable="false"
            id="sernet.verinice.model.iso27k.Audit"
            objectClass="sernet.verinice.model.iso27k.Audit">
         <menu id="workflow"
			   label="%menu.label.workflow"
			   icon="icons/tasks.gif"
			   path="special"> 
			   <separator name="create"/>
			   <separator name="special"/>
		 </menu>
         <action
               class="sernet.verinice.samt.rcp.AssignAllIsaTopics"
               enablesFor="+"
               icon="icons/user.png"
               id="sernet.verinice.samt.rcp.AssignAllIsaTopics"
               label="%action.label.15"
               menubarPath="workflow/special"
               style="push"
               tooltip="%action.tooltip.3">
         </action>
      </objectContribution>
   </extension>
</plugin>
